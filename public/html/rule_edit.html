<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Rule</title>

    <link rel="stylesheet" href="/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="/css/rule_edit.css">
    <script src="/js/knockout/knockout-3.4.0.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>

    <script src="/js/rule_ui/rule_container.js"></script>
    <script src="/js/rule_ui/sidebar.js"></script>
    <script src="/js/rule_ui/graphics.js"></script>
</head>
<body>
<div id="navbar"></div>

<div id="all-sidebars">
    <div class="sidebar-container" data-bind="if: curType()===''">
        <div class="panel panel-default">
            <h5><strong>Select Type</strong></h5>
            <select id="type-select"
                    class="form-control"
                    data-bind="value: curType">
                <option value="" disabled selected>Choose one</option>
                <optgroup label="Decisions">
                    <option value="TimeDecision">Time</option>
                    <option value="DayDecision">Day</option>
                    <option value="DataDecision">Datastream</option>
                    <option value="EventDecision">Event</option>
                </optgroup>
                <optgroup label="Actions">
                    <option value="NodeInput">Actuate Node</option>
                </optgroup>
            </select>
        </div>
    </div>

    <div class="sidebar-container" data-bind="visible: curType()==='TimeDecision'">
        <div class="panel panel-default">
            <h4>Time Decision</h4>
            <h5>Branches</h5>
            <div data-bind="foreach: ranges" class="form-group">
                <div class="row branch-row">
                    <div class="branch-delete">
                        <button data-bind="click: $root.deleteBranch.bind($data, $index())"
                                type="button" class="btn btn-danger">
                            <span class="glyphicon glyphicon-remove-circle"></span>
                        </button>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">Start</span>
                            <input type="time"
                                   data-bind="value: $root.toDateString($data[0])"
                                   placeholder="Range start"
                                   class="form-control">
                        </div>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">End</span>
                            <input type="time"
                                   data-bind="value: $root.toDateString($data[1])"
                                   placeholder="Range end"
                                   class="form-control">
                        </div>
                    </div>
                </div>
            </div>
            <button data-bind="click: addBranch" type="button" class="btn btn-block btn-primary">New branch</button>
        </div>
    </div>

    <div class="sidebar-container" data-bind="visible: curType()==='DayDecision'">
        <div class="panel panel-default">
            <h4>Day Decision</h4>
            <h5>Branches</h5>
            <div data-bind="foreach: ranges" class="form-group">
                <div class="row branch-row">
                    <div class="branch-delete">
                        <button data-bind="click: $root.deleteBranch.bind($data, $index())"
                                type="button" class="btn btn-danger">
                            <span class="glyphicon glyphicon-remove-circle"></span>
                        </button>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">Start</span>
                            <select class="form-control"
                                    data-bind="options: $root.days,
                                               optionsText: 'name',
                                               optionsValue: 'id',
                                               value: $data[0]"></select>
                        </div>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">End</span>
                            <select class="form-control"
                                    data-bind="options: $root.days,
                                               optionsText: $root.inclusiveEndDay,
                                               optionsValue: 'id',
                                               value: $data[1]"></select>
                        </div>
                    </div>
                </div>
            </div>
            <button data-bind="click: addBranch" type="button" class="btn btn-block btn-primary">New branch</button>
        </div>
    </div>

    <div class="sidebar-container" data-bind="visible: curType()==='DataDecision'">
        <div class="panel panel-default">
            <h4>Data Decision</h4>
            <h5>Choose Datastream</h5>
            <select
                    data-bind="options: continuousDatastreams,
                                optionsText: 'name',
                                optionsValue: 'id',
                                value: selectedDatastream,
                                valueAllowUnset: true"
                    class="form-control"></select>

            <h5>Branches</h5>
            <div data-bind="foreach: ranges" class="form-group">
                <div class="row branch-row">
                    <div class="branch-delete">
                        <button data-bind="click: $root.deleteBranch.bind($data, $index())"
                                type="button" class="btn btn-danger">
                            <span class="glyphicon glyphicon-remove-circle"></span>
                        </button>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">Start</span>
                            <input type="text"
                                   data-bind="textInput: $data.start, event: {keyup: $root.branchesChanged}"
                                   placeholder="Range start"
                                   class="form-control">
                        </div>
                    </div>
                    <div class="branch-row">
                        <div class="input-group">
                            <span class="input-group-addon">End</span>
                            <input type="text"
                                   data-bind="textInput: $data.end, event: {keyup: $root.branchesChanged}"
                                   placeholder="Range end"
                                   class="form-control">
                        </div>
                    </div>
                </div>
            </div>
            <button data-bind="click: addBranch" type="button" class="btn btn-block btn-primary">New branch</button>
        </div>
    </div>

    <div class="sidebar-container" data-bind="visible: curType()==='EventDecision'">
        <div class="panel panel-default">
            <h5>Event Decision</h5>
        </div>
    </div>

    <div class="sidebar-container" data-bind="visible: curType()==='NodeInput'">
        <div class="panel panel-default">
            <h4>Actuate Node</h4>
            <h5><strong>Choose which node</strong></h5>
            <select
                data-bind="options: nodes, optionsText: 'name', optionsValue: 'id', value: selectedNode, valueAllowUnset: true"
                class="form-control"></select>

            <h5><strong>Decide Data</strong></h5>
            <form class="form-horizontal" id="actuate_form" data-bind="if: selectedNode() != -1">
                <div data-bind="foreach: getActiveNode().inputNames" class="form-group">
                    <label data-bind="text: $data, attr: {'for': 'actuate_' + $data()" class="col-sm-2 control-label">$</label>
                    <div class="col-sm-10">
                        <input type="text"
                               data-bind="textInput: $root.data[$index()], attr: {'id': 'actuate_' + $data()"
                               class="form-control"
                               placeholder="Enter Data">
                    </div>
                </div>
            </form>

        </div>
    </div>
</div>

</body>
</html>